<!doctype html>
<html data-n-head-ssr lang="en" data-n-head="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>Lưu ý khi sử dụng save_post để lưu post meta trong wordpress | TianDev</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" name="format-detection" content="telephone=no"><meta data-n-head="ssr" name="google-site-verification" content="qdcZOoSAayf1c2-iruOw1pnz-BDzHmir7xZmTNs6ajk"><meta data-n-head="ssr" data-hid="og:site_name" property="og:site_name" content="TianDev | Developer Blog"><meta data-n-head="ssr" data-hid="og:type" property="og:type" content="website"><meta data-n-head="ssr" data-hid="fb:app_id" property="fb:app_id" content="399524598269268"><meta data-n-head="ssr" data-hid="twitter:site" name="twitter:site" content="@TianDev"><meta data-n-head="ssr" data-hid="twitter:card" name="twitter:card" content="summary_large_image"><meta data-n-head="ssr" data-hid="og:image" property="og:image" content="https://tiandev.net/img/tiandev_card.png"><meta data-n-head="ssr" data-hid="og:image:secure_url" property="og:image:secure_url" content="https://tiandev.net/img/tiandev_card.png"><meta data-n-head="ssr" data-hid="og:image:alt" property="og:image:alt" content="TianDev"><meta data-n-head="ssr" data-hid="twitter:image" name="twitter:image" content="https://tiandev.net/img/tiandev_card.png"><meta data-n-head="ssr" data-hid="charset" charset="utf-8"><meta data-n-head="ssr" data-hid="mobile-web-app-capable" name="mobile-web-app-capable" content="yes"><meta data-n-head="ssr" data-hid="apple-mobile-web-app-title" name="apple-mobile-web-app-title" content="TianDev"><meta data-n-head="ssr" data-hid="theme-color" name="theme-color" content="#00C58E"><meta data-n-head="ssr" data-hid="description" name="description" content="save_post là action được kích hoạt bất cứ khi nào đăng bài mới và cập nhật post theo mọi hình thức đều sẽ đi qua action này."><meta data-n-head="ssr" data-hid="og:url" property="og:url" content="https://tiandev.net/luu-y-khi-su-dung-save_post-de-luu-custom-field-trong-wordpress/"><meta data-n-head="ssr" data-hid="og:title" property="og:title" content="Lưu ý khi sử dụng save_post để lưu post meta trong wordpress | TianDev"><meta data-n-head="ssr" data-hid="og:description" property="og:description" content="save_post là action được kích hoạt bất cứ khi nào đăng bài mới và cập nhật post theo mọi hình thức đều sẽ đi qua action này."><meta data-n-head="ssr" data-hid="twitter:title" name="twitter:title" content="Lưu ý khi sử dụng save_post để lưu post meta trong wordpress | TianDev"><meta data-n-head="ssr" data-hid="twitter:description" name="twitter:description" content="save_post là action được kích hoạt bất cứ khi nào đăng bài mới và cập nhật post theo mọi hình thức đều sẽ đi qua action này."><link data-n-head="ssr" rel="icon" type="image/x-icon" href="/favicon.ico"><link data-n-head="ssr" data-hid="shortcut-icon" rel="shortcut icon" href="/public/icons/icon_64x64.06844b.png"><link data-n-head="ssr" data-hid="apple-touch-icon" rel="apple-touch-icon" href="/public/icons/icon_512x512.06844b.png" sizes="512x512"><link data-n-head="ssr" rel="manifest" href="/public/manifest.5c92551d.json" data-hid="manifest"><link data-n-head="ssr" data-hid="canonical" rel="canonical" href="https://tiandev.net/luu-y-khi-su-dung-save_post-de-luu-custom-field-trong-wordpress/"><link rel="preload" href="/public/762dbf8.js" as="script"><link rel="preload" href="/public/2ae72be.js" as="script"><link rel="preload" href="/public/css/4e01be0.css" as="style"><link rel="preload" href="/public/38c9442.js" as="script"><link rel="preload" href="/public/css/612589e.css" as="style"><link rel="preload" href="/public/33b1cc2.js" as="script"><link rel="preload" href="/public/f804b6e.js" as="script"><link rel="stylesheet" href="/public/css/4e01be0.css"><link rel="stylesheet" href="/public/css/612589e.css"><link rel="preload" href="/public/static/1628438263/luu-y-khi-su-dung-save_post-de-luu-custom-field-trong-wordpress/state.js" as="script"><link rel="preload" href="/public/static/1628438263/luu-y-khi-su-dung-save_post-de-luu-custom-field-trong-wordpress/payload.js" as="script"><link rel="preload" href="/public/static/1628438263/manifest.js" as="script">
  </head>
  <body>
    <div data-server-rendered="true" id="__tiandev"><!----><div id="__layout"><div><header class="header text-center"><div class="force-overflow"><h1 class="blog-name pt-lg-4 mb-0"><a href="https://tiandev.net" class="no-text-decoration">TianDev</a></h1> <nav class="navbar navbar-expand-lg navbar-dark"><button type="button" data-bs-toggle="collapse" class="navbar-toggler"><span class="navbar-toggler-icon"></span></button> <div id="navigation" class="collapse navbar-collapse flex-column"><div class="profile-section pt-3 pt-lg-0"><img src="/img/tiandev_logo.png" alt="avatar" class="profile-image mb-3 rounded-circle mx-auto"> <div class="bio mb-3">
                        Chào mừng bạn đến với blog của tôi <br>
                        Là một "Developer notes" về lập trình
                    </div> <hr></div> <ul class="navbar-nav flex-column text-start"><li class="nav-item"><a href="https://tiandev.net" class="nav-link"><i aria-hidden="true" class="inline--fa fa fa-home"></i>
                            Home
                        </a></li> <li class="nav-item"><a href="/tags/" class="nav-link"><i aria-hidden="true" class="inline--fa fa fa-tags"></i>
                             Tags
                        </a></li> <li class="nav-item"><a href="/archives/" class="nav-link"><i aria-hidden="true" class="inline--fa fa fa-briefcase"></i>
                            Archives
                        </a></li> <li class="nav-item"><a href="/video/" class="nav-link"><i aria-hidden="true" class="inline--fa fa fa-laptop-code"></i>
                            Video
                        </a></li> <li class="nav-item"><a href="/about/" class="nav-link"><i aria-hidden="true" class="inline--fa fa fa-user"></i>
                            About Me
                        </a></li></ul></div></nav></div> <ul class="social-list list-inline py-2 mx-auto"><li class="list-inline-item"><a href="https://github.com/anhkevin" target="_blank"><i aria-hidden="true" class="inline--fa fab fa-github-alt"></i></a></li> <li class="list-inline-item"><a href="javascript:window.open('mailto:' + ['anhkevin.ht','gmail.com'].join('@'))"><i aria-hidden="true" class="inline--fa fa fa-envelope"></i></a></li> <li class="list-inline-item"><a href="https://www.youtube.com/c/tiandev" target="_blank"><i aria-hidden="true" class="inline--fa fab fa-youtube"></i></a></li></ul></header> <div class="main-wrapper"><article class="blog-post px-3 py-5 p-md-5"><div class="container single-col-max-width"><header class="blog-post-header"><h2 class="title mb-2">Lưu ý khi sử dụng save_post để lưu post meta trong wordpress</h2> <div class="meta mb-3"><span class="date">Posted: December 3, 2019</span> by <span class="author"> anhkevin </span></div></header> <div class="blog-post-body"><div class="nuxt-content"><p><strong>save_post</strong> là action được kích hoạt bất cứ khi nào đăng bài mới và cập nhật post theo mọi hình thức đều sẽ đi qua action này.</p>
<p><strong><span style="font-size:14pt">Vậy vấn đề ở đây là gì?</span></strong></p>
<p><strong>VD:</strong> Sử dụng đoạn code phía dưới để thêm hay cập nhật dữ liệu post meta cho post type</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-php"><code><span class="token keyword">function</span> <span class="token function-definition function">update_post</span><span class="token punctuation">(</span><span class="token variable">$post_id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//[START][CODING] - post meta</span>
    <span class="token variable">$link_download</span> <span class="token operator">=</span> <span class="token global">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'link_download'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">update_post_meta</span><span class="token punctuation">(</span> <span class="token variable">$post_id</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'_link_download'</span><span class="token punctuation">,</span> <span class="token variable">$link_download</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//[END][CODING] - post meta</span>
<span class="token punctuation">}</span>
<span class="token function">add_action</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'save_post'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'update_post'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>Khi đó mọi hình thức update đều vào action ‘save_post’ này.<br>
Trường hợp sử dụng chức năng khác để update dữ liệu nhưng chức năng đó không có dữ liệu custom field, chẳng hạn như sử dụng chức năng "Quick edit", "Revision" => lúc này không có dữ liệu post meta, nếu bạn chỉ get dữ liệu _POST về rồi update thì lúc này dữ liệu sẽ bị update thành dữ liệu trống</p>
<p><strong>- Trường hợp này có nhiều cách giải quyết</strong></p>
<ol>
<li>Kiểm tra isset trước khi xử lý</li>
</ol>
<div class="nuxt-content-highlight"><pre class="line-numbers language-text"><code>if(isset($_POST['link_download'])) {
...
}

</code></pre></div>
<ol start="2">
<li>Check thêm điều kiện trường hợp ở màn hình add hoặc edit mới xử lý</li>
</ol>
<p>…<br>
tùy vào mục đích thì sẽ có cách xử lý riêng</p>
<p><strong>=> Bài viết này chỉ là lưu ý khi sủ dụng save_post để cập nhật bất kỳ dữ liệu của post type.</strong></p>
<div id="gtx-trans" style="position:absolute;left:150px;top:264px">
  <div class="gtx-trans-icon">
  </div>
</div></div></div> <div class="blog-nav nav nav-justified my-5"><div class="post-tags mb-3"><span class="fw-bold">Tags: </span> <a href="/tags/Wordpress" class="post-tag no-text-decoration"><span class="badge bg-light text-dark">Wordpress</span></a></div></div> <div class="blog-comments-section"><div id="disqus_thread" style="min-height:200px"></div></div></div></article> <footer class="footer text-center py-4"><small class="copyright">Copyright © 2021 - <a href="https://tiandev.net" target="_blank">TianDev</a></small></footer></div></div></div></div><script defer src="/public/static/1628438263/luu-y-khi-su-dung-save_post-de-luu-custom-field-trong-wordpress/state.js"></script><script src="/public/762dbf8.js" defer></script><script src="/public/f804b6e.js" defer></script><script src="/public/2ae72be.js" defer></script><script src="/public/38c9442.js" defer></script><script src="/public/33b1cc2.js" defer></script>
  </body>
</html>
